{"mappings":"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","sources":["src/js/favorites.js","src/js/createMarkupFunctions/createEmptyFavorites.js"],"sourcesContent":["import createSneakersMarkup from './createMarkupFunctions/createSneakersMarkup';\nimport { setFavoritesOnload } from './handleFavorites';\nimport { createEmptyFavorites } from './createMarkupFunctions/createEmptyFavorites';\nimport { setActualPriceIntoHeader } from './calculateTotalPrice';\nimport { setInCartOnload } from './handleCart';\nimport { getSneakerById } from '../api/api';\nimport { themeSwitch, setThemeOnLoad } from './themeSwitch';\nimport { modalHandler } from './displayCart';\nimport './mobileMenu';\nimport { openModal } from './handleAuthForm';\nimport { db, signOut } from '../firebase';\nimport 'firebase/compat/firestore';\n// import { handleCart } from './handleCart';\n\nconst headerGroup = document.querySelector('.header__user__icons__group');\nconst btnLogOut = document.querySelector('.btn__log__out');\n\ndb.auth().onAuthStateChanged(user => {\n  if (user) {\n    console.log(' USER =>', user);\n    console.log('promise');\n\n    setTimeout(() => {\n      setInCartOnload();\n      setFavoritesOnload();\n    }, 2000);\n    setActualPriceIntoHeader();\n\n    console.log(' USER =>', user);\n    document.querySelector('.header__user__user__name').textContent = user.displayName;\n    headerGroup.classList.add('visible');\n    btnLogOut.classList.add('visible');\n\n    console.log(user.displayName);\n  } else {\n    headerGroup.classList.remove('visible');\n    btnLogOut.classList.remove('visible');\n  }\n});\n\nsetThemeOnLoad();\ndocument.querySelector('.theme__switch').addEventListener('change', themeSwitch);\ndocument.addEventListener('click', modalHandler);\n\nbtnLogOut.addEventListener('click', () => {\n  signOut().then(() => {\n    db.auth().onAuthStateChanged(user => {\n      if (!user) {\n        window.location.href = 'index.html';\n      }\n    });\n  });\n});\nconst userButton = document.querySelector('.header__user__icon__user');\nuserButton.addEventListener('click', openModal);\n\nconst list = document.querySelector('.favoritesList__list');\nlist.addEventListener('click', handleFavorites);\nlist.addEventListener('click', handleCart);\n\nfunction handleAuthStateChanged(user) {\n  if (user) {\n    console.log('USER =>', user);\n    console.log('db.auth().currentUser.uid', db.auth().currentUser.uid);\n    db\n      .firestore()\n      .collection('favorites')\n      .where('userId', '==', db.auth().currentUser.uid)\n      .onSnapshot(\n        snapshot => {\n          const favorites = snapshot.docs.map(doc => doc.data()) || [];\n          console.log(favorites);\n          if (favorites.length === 0) {\n            emptyFavorites();\n          } else {\n            list.insertAdjacentHTML('afterbegin', createSneakersMarkup(favorites));\n            setFavoritesOnload();\n            setInCartOnload();\n          }\n        },\n        error => {\n          console.log('–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error);\n        },\n      );\n  }\n}\ndb.auth().onAuthStateChanged(handleAuthStateChanged);\n\nsetActualPriceIntoHeader();\n\nfunction emptyFavorites() {\n  const favoritesList = document.querySelector('.favoritesList__list');\n  favoritesList.innerHTML = createEmptyFavorites();\n}\n\nasync function handleFavorites(event) {\n  const heart = event.target;\n\n  if (heart.classList.contains('sneaker__heart__button')) {\n    const sneaker = heart.closest('li');\n\n    if (heart.classList.contains('active')) {\n\n      heart.classList.remove('active');\n      const docId = await db.firestore().collection('favorites').get();\n      docId.forEach(async item => {\n        const currentSneaker = item.data();\n        if (currentSneaker.id === sneaker.id) {\n          await db.firestore().collection('favorites').doc(item.id).delete();\n        }\n      });\n      sneaker.remove();\n      list.innerHTML = '';\n    }\n  }\n\n  db.firestore()\n    .collection('favorites')\n    .get()\n    .then(querySnapshot => {\n      if (querySnapshot.empty) {\n        console.log('–ö–æ–ª–µ–∫—Ü—ñ—è –ø–æ—Ä–æ–∂–Ω—è');\n        emptyFavorites();\n      } else {\n        console.log('–ö–æ–ª–µ–∫—Ü—ñ—è –Ω–µ –ø–æ—Ä–æ–∂–Ω—è');\n      }\n    })\n    .catch(error => {\n      console.log('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö –∑ –∫–æ–ª–µ–∫—Ü—ñ—ó:', error);\n    });\n}\n\nasync function handleCart(event) {\n  const cart = event.target;\n\n  if (cart.classList.contains('sneaker__add__button')) {\n    const sneakerId = cart.parentNode.parentNode.id;\n    const selectedSneaker = await getSneakerById(sneakerId) || {};\n\n    if (cart.classList.contains('active')) {\n      cart.classList.remove('active');\n      const docId = await db.firestore().collection('cart').get();\n      docId.forEach(async item => {\n        const currentSneaker = item.data();\n        if (currentSneaker.id === selectedSneaker.id) {\n          await db.firestore().collection('cart').doc(item.id).delete();\n        }\n      });\n      setActualPriceIntoHeader();\n      return;\n    }\n    await db.auth().onAuthStateChanged(async user => {\n      if (user) {\n        cart.classList.add('active');\n        await db\n          .firestore()\n          .collection('cart')\n          .add({ ...selectedSneaker, userId: db.auth().currentUser.uid });\n\n        setActualPriceIntoHeader();\n      } else {\n        console.log('—â–æ–± –¥–æ–¥–∞—Ç–∏ —É –∫–æ—Ä–∑–∏–Ω—É - –∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Å—è');\n      }\n    });\n  }\n}\n","export function createEmptyFavorites () {\n    return `<div class=\"emptyContentFavorites__wrapper\" >\n    <div class=\"emptyContentFavorites__img\">ü•∫</div>\n    <h3 class=\"emptyContentFavorites__title\">Favorites not found</h3>\n    <p class=\"emptyContentFavorites__text\">You have not added anything to favorites</p>\n    <div class='emptyContentFavorites__container__button'>\n    <a href=\"index.html\" class=\"emptyContentFavorites__button\">Return</a>\n    </div>\n    </div>`\n}\n"],"names":[],"version":3,"file":"favorites.81007f9e.js.map"}
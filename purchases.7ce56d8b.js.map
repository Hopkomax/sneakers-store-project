{"mappings":"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","sources":["src/js/themeSwitch.js","src/js/handleCart.js","src/js/createMarkupFunctions/createCartMarkup.js","src/js/createMarkupFunctions/createMakeOrderMarkup.js","src/js/displayCart.js","src/js/createMarkupFunctions/createSneakersMarkupInCart.js","src/js/purchases.js","src/js/createMarkupFunctions/createEmptyPurchases.js","src/js/createMarkupFunctions/createPurchasesMarkup.js"],"sourcesContent":["const switchElement = document.querySelector('.theme__switch');\n\nexport function themeSwitch() {\n  console.log(switchElement.checked);\n  if (switchElement.checked) {\n    document.body.classList.add('dark');\n    localStorage.setItem('theme', 'dark');\n  } else {\n    document.body.classList.remove('dark');\n    localStorage.setItem('theme', 'light');\n  }\n}\n\nexport function setThemeOnLoad() {\n  const currentTheme = localStorage.getItem('theme');\n  document.body.classList.add(currentTheme);\n\n  if (currentTheme === 'dark') {\n    switchElement.checked = true;\n  }\n}\n","import { setActualPriceIntoHeader } from './calculateTotalPrice';\nimport { getSneakerById } from '../api/api';\nimport { db } from '../firebase';\nimport 'firebase/compat/firestore';\n\nexport async function handleCart(event) {\n  const cart = event.target;\n  console.log(cart);\n  if (cart.classList.contains('sneaker__add__button')) {\n    const sneakerId = cart.parentNode.parentNode.id;\n    const selectedSneaker = (await getSneakerById(sneakerId)) || {};\n    // const inCart = JSON.parse(localStorage.getItem('inCart')) || [];\n    //console.log(inCart);\n    if (cart.classList.contains('active')) {\n      // const updatedCart = inCart.filter(({ id }) => id !== sneakerId);\n      // console.log(updatedCart);\n      //localStorage.setItem('inCart', JSON.stringify(updatedCart));\n      cart.classList.remove('active');\n      console.log(cart);\n      // work with FIREBASE\n      const docId = await db.firestore().collection('cart').get();\n      docId.forEach(async item => {\n        const currentSneaker = item.data();\n        if (currentSneaker.id === selectedSneaker.id) {\n          await db.firestore().collection('cart').doc(item.id).delete();\n        }\n      });\n\n      setActualPriceIntoHeader();\n      return;\n    }\n    await db.auth().onAuthStateChanged(async user => {\n      if (user) {\n        cart.classList.add('active');\n        await db\n          .firestore()\n          .collection('cart')\n          .add({ ...selectedSneaker, userId: db.auth().currentUser.uid });\n\n        setActualPriceIntoHeader();\n      } else {\n        console.log('щоб додати у корзину - зареєструйся');\n      }\n    });\n    //inCart.push(selectedSneaker);\n    //localStorage.setItem('inCart', JSON.stringify(inCart));\n    // add sneakers to FIREBASE\n    await db\n      .firestore()\n      .collection('cart')\n      .add({ ...selectedSneaker, userId: db.auth().currentUser.uid });\n\n    setActualPriceIntoHeader();\n  }\n}\n\nexport function setInCartOnload() {\n  // const inCart = JSON.parse(localStorage.getItem('inCart')) || [];\n  db.firestore()\n    .collection('cart')\n    .where('userId', '==', db.auth().currentUser.uid)\n    .onSnapshot(\n      snapshot => {\n        const inCart = snapshot.docs.map(doc => doc.data()) || [];\n        document\n          .querySelectorAll('.sneaker__add__button.active')\n          .forEach(item => item.classList.remove('active'));\n\n        for (const { id } of inCart) {\n          const item = document.getElementById(id);\n\n          if (!item) {\n            continue;\n          }\n          // Якщо item === null (getElementById(id) не знайшов такого елементу на сторінці), то ми пропустимо ту ітерацію, і йти до наступної (continue пропускає ітерацію)\n          const cartButton = item.querySelector('.sneaker__add__button');\n          cartButton.classList.add('active');\n        }\n      },\n      error => {\n        console.log('Помилка отримання даних:', error);\n      },\n    );\n}\n","import { handleDelete } from '../deleteItemInCart';\nimport createMakeOrderMarkup from './createMakeOrderMarkup';\n\nexport default function createCartMarkup() {\n  document.querySelector('.cartList').innerHTML = `\n  <div class=\"cartList__container\">\n    <div class=\"cart__container__top__blok\">\n    <h2 class=\"cartList__title\">Cart</h2>\n    <ul class=\"cartList__list\"></ul>\n</div>\n    <div class=\"cart__container__bottom__blok\">\n      <div class=\"sneaker__inCart__totalAmount\">\n        <p>Total</p>\n        <span></span>\n        <p>UAH</p>\n      </div>\n      <div class=\"sneaker__inCart__taxes\">\n        <p>VAT 5%</p>\n        <span></span>\n        <p>UAH</p>\n      </div>\n      <div class=\"cart__container__button__blok\">\n        <button class=\"cart__container__button\">Make order</button>\n      </div>\n    </div>\n  </div>`;\n  \n  const cartList = document.querySelector('.cartList__list');\n  const makeOrderButton = document.querySelector('.cart__container__button');\n\n  cartList.addEventListener('click', handleDelete);\n  makeOrderButton.addEventListener('click', createMakeOrderMarkup);\n}\n","export default function createMakeOrderMarkup() {\n\n  const inCartItems = localStorage.getItem('inCart');\n  let purchasesItems = localStorage.getItem('purchases');\n\n  if (!purchasesItems) {\n    purchasesItems = []; // Initialize as an empty array if purchasesItems is null or empty\n  } else {\n    purchasesItems = JSON.parse(purchasesItems); // Parse the stringified array\n  }\n\n  if (inCartItems) {\n    const combinedItems = purchasesItems.concat(JSON.parse(inCartItems));\n    localStorage.setItem('purchases', JSON.stringify(combinedItems));\n  }\n\n  localStorage.removeItem('inCart');\n  document.querySelector('.cartList__container').innerHTML = `\n    <div class=\"emptyContentOrder__wrapper\" >\n    <div class=\"emptyContentOrder__img\"></div>\n    <h3 class=\"emptyContentOrder__title\">Order is processed!</h3>\n    <p class=\"emptyContentOrder__text\">Your order will be delivered to courier soon</p>\n    <div class='emptyContentOrder__container__button'>\n    <a href=\"index.html\" class=\"emptyContentOrder__button\">Return</a>\n    </div>\n    </div>`;\n\n}\n","import createSneakersMarkupInCart from './createMarkupFunctions/createSneakersMarkupInCart';\nimport { setActualPriceIntoCart, setActualPriceIntoHeader } from './calculateTotalPrice';\nimport { setInCartOnload } from './handleCart';\nimport createCartMarkup from './createMarkupFunctions/createCartMarkup';\nimport createEmptyCart from './createMarkupFunctions/createEmptyCart';\nimport { db } from '../firebase';\nimport 'firebase/compat/firestore';\n\nlet list = null;\nconst backdrop = document.querySelector('#modal-backdrop');\nconst modalCart = document.querySelector('.cartList');\nlet unsubscribe = null;\n\ndocument.addEventListener('click', modalHandler);\n\nexport function modalHandler(evt) {\n  // const inCart = JSON.parse(localStorage.getItem('inCart')) || [];\n  const modalBtnOpen = evt.target.closest('.header__user__icon__cart');\n  \n  if (modalBtnOpen) {\n    createCartMarkup();\n\n    list = document.querySelector('.cartList__list');\n\n    // open btn click\n    showModal(modalCart);\n    setActualPriceIntoCart();\n\n    unsubscribe = db.firestore()\n    .collection('cart')\n    .where('userId', '==', db.auth().currentUser.uid)\n    .onSnapshot(snapshot => {\n      const inCart = snapshot.docs.map(doc => doc.data()) || [];\n      console.log(inCart);\n      if (inCart.length === 0) {\n        const cart = document.querySelector('.cartList__container');\n        cart.innerHTML = createEmptyCart();\n      } else {\n        list.innerHTML = createSneakersMarkupInCart(inCart);\n      }\n    }, error => {\n      console.log('Помилка отримання даних:', error);\n    });\n\n\n    // if (inCart.length === 0) {\n    //   const cart = document.querySelector('.cartList__container');\n    //   cart.innerHTML = createEmptyCart();\n    // } else {\n    //   list.innerHTML = createSneakersMarkupInCart(inCart);\n    // }\n  }\n\n  if (evt.target.matches('#modal-backdrop')) {\n    list.innerHTML = '';\n    hideModal(modalCart);\n    setActualPriceIntoHeader();\n    setInCartOnload();\n  }\n}\n\nexport function showModal(modalElem) {\n  modalElem.classList.add('active');\n  backdrop.classList.remove('hidden');\n  document.body.style.overflow = 'hidden';\n}\n\nexport function hideModal(modalElem) {\n  modalElem.classList.remove('active');\n  backdrop.classList.add('hidden');\n  document.body.style.overflow = 'visible';\n}\ndocument.addEventListener('keydown', function (event) {\n  if (event.key === 'Escape') {\n    hideModal(modalCart);\n  }\n});\n","export default function createSneakersMarkupInCart(items) {\n  const markup = items\n    .map(({ title, images, price, id }) => {\n      return `\n      <li class='sneaker__inCart__item'id=${id}>\n      <img class='sneaker__inCart__img' src=\"${images[0]}\" alt=\"${title}\">\n      <div class='sneaker__inCart__description'>\n          <h3>${title}</h3>\n          <p>${price} UAH</p>\n      </div>\n      <div class='sneaker__inCart__button'>\n          <span class='sneaker__inCart__button-span'>x</span>\n      </div>\n  </li>`;\n    })\n    .join(' ');\n  return markup;\n}\n","import createSneakersMarkup from './createMarkupFunctions/createSneakersMarkup';\nimport { themeSwitch, setThemeOnLoad } from './themeSwitch';\nimport { modalHandler } from './displayCart';\nimport { setActualPriceIntoHeader } from './calculateTotalPrice';\nimport createPurchasesMarkup from './createMarkupFunctions/createPurchasesMarkup';\nimport createSneakersMarkupInCart from './createMarkupFunctions/createSneakersMarkupInCart';\nimport { createEmptyPurchases } from './createMarkupFunctions/createEmptyPurchases';\nconst list = document.querySelector('.purchasesList__list');\n\nsetThemeOnLoad();\nsetActualPriceIntoHeader();\n\ndocument.querySelector('.theme__switch').addEventListener('change', themeSwitch);\n\nconst purchases = JSON.parse(localStorage.getItem('purchases')) || [];\nif(purchases.length === 0){\n  emptyPurchases();\n} else{\nlist.insertAdjacentHTML('afterbegin', createPurchasesMarkup(purchases));\n}\nfunction emptyPurchases() {\n  const purchasesList = document.querySelector('.purchasesList__list');\n  purchasesList.innerHTML = createEmptyPurchases();\n}\n","export function createEmptyPurchases () {\n    return `<div class=\"emptyContentPurchases__wrapper\" >\n    <div class=\"emptyContentPurchases__img\">🥺</div>\n    <h3 class=\"emptyContentPurchases__title\">Purchases not found</h3>\n    <p class=\"emptyContentPurchases__text\">You have not added anything to Purchases</p>\n    <div class='emptyContentPurchases__container__button'>\n    <a href=\"index.html\" class=\"emptyContentPurchases__button\">Return</a>\n    </div>\n    </div>`\n}","export default function createPurchasesMarkup(items) {\n  const markup = items\n  .map(({ title, images, price, id }) => {\n    return `\n    <li class='sneaker__InPurchases__item'id=${id}>\n    <img class='sneaker__InPurchases__img' src=\"${images[0]}\" alt=\"${title}\">\n    <div class='sneaker__InPurchases__description'>\n        <h3>${title}</h3>\n        <p>${price} UAH</p>\n    </div>\n</li>`;\n  })\n  .join(' ');\nreturn markup;\n}"],"names":["$835edf57c3be19f6$var$switchElement","document","querySelector","$gTT0W","parcelRequire","$aROVc","$e5bdbf7e43311375$export$2e2bcd8739ae039","inCartItems","localStorage","getItem","purchasesItems","JSON","parse","combinedItems","concat","setItem","stringify","removeItem","innerHTML","$3429ac0e41866916$export$2e2bcd8739ae039","cartList","makeOrderButton","addEventListener","handleDelete","$7e213f0fa6007110$var$list","$7e213f0fa6007110$var$backdrop","$7e213f0fa6007110$var$modalCart","$7e213f0fa6007110$var$unsubscribe","$7e213f0fa6007110$export$af4939467128bcd0","modalElem","classList","remove","add","body","style","overflow","evt","target","closest","setActualPriceIntoCart","$cEKo3","db","firestore","collection","where","auth","currentUser","uid","onSnapshot","snapshot","inCart","docs","map","doc","data","console","log","length","$sLsIj","default","title","images","price","id","join","error","matches","setActualPriceIntoHeader","querySelectorAll","forEach","item","getElementById","event","key","$f2bdc3565cf5c637$var$list","currentTheme","checked","$f2bdc3565cf5c637$var$purchases","insertAdjacentHTML"],"version":3,"file":"purchases.7ce56d8b.js.map"}